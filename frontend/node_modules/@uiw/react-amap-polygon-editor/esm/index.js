import _extends from "@babel/runtime/helpers/extends";
import { forwardRef, useEffect, useImperativeHandle, useState } from 'react';
import { useEventProperties } from '@uiw/react-amap-utils';
import { useMapContext } from '@uiw/react-amap-map';
export var PolygonEditor = /*#__PURE__*/forwardRef((props, ref) => {
  var {
    active,
    polygon
  } = props;
  var {
    map
  } = useMapContext();
  var [visiable, setVisiable] = useState(true);
  var [polyEditor, setPolyEditor] = useState();
  useImperativeHandle(ref, () => _extends({}, props, {
    polyEditor
  }));
  useEffect(() => {
    if (polygon && map && !polyEditor && AMap && AMap.PolygonEditor) {
      var instance = new AMap.PolygonEditor(map, polygon);
      polygon.on('hide', () => setVisiable(false));
      polygon.on('show', () => setVisiable(true));
      setPolyEditor(instance);
    }
  }, [polygon]);
  useEffect(() => {
    if (!polyEditor) {
      return;
    }
    if (visiable && !active) {
      polyEditor.close();
      props.onEnd && props.onEnd({
        target: props.polygon
      });
    } else if (visiable && active) {
      polyEditor.open();
      props.onAdd && props.onAdd({
        target: props.polygon
      });
    } else if (!visiable && active) {
      polyEditor.close();
      props.onEnd && props.onEnd({
        target: props.polygon
      });
    }
  }, [active, visiable]);
  useEventProperties(polyEditor, props, ['onEnd', 'onAddnode', 'onRemovenode', 'onAdjust', 'onMove', 'onAdd']);
  return null;
});